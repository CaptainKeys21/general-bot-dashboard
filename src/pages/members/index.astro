---
import MemberCard from '../../components/member/memberCard.astro';
import MembersLayout from '../../layouts/membersLayout.astro';
import type { DiscordMember } from '../../types/Discord';
import type { IApiPagedResponse } from '../../types/Responses';
import axios from '../../utils/axios';

let memberList: IApiPagedResponse<DiscordMember[]> | undefined;
try {
  const res = await axios.get<IApiPagedResponse<DiscordMember[]>>('/members');
  memberList = res.data;
} catch (error) {
  Astro.redirect('/404');
}
---
<MembersLayout>
  {memberList && memberList.data.map((member) => <MemberCard data={member} />)}
</MembersLayout>